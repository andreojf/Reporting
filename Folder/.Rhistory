sheet = "Situation Globale Retr",
skip = 8)
df <- df[1:(nrow(df)-1),]
df <- df %>%
mutate(Pays = basename(dirname(filepath)))
return(df)
}
#df <- importFile("FichiersExcel//NG/ENGAGEMENT_PORTEFEUILLE DE CBI NG au 31.12.2020.xlsx")
filepaths <- list.files(path="FichiersExcel/",
recursive=T,
pattern=".xlsx",
full.names=T)
df.list <- lapply(filepaths, importFile)
final.df <- rbind.fill(df.list)
## Store the output
write.csv(final.df,"C:/Users/jaouedraogo/Documents/Coris/Reporting/Folder/Inputs.csv", row.names = FALSE)
## Store the output
write.csv(final.df,"C:/Users/jaouedraogo/Documents/Coris/Reporting/Folder/Inputs.csv", row.names = FALSE)
unique(final.df$Pays)
runApp('~/R/Applications')
##### QUALITE DU PORTEFEUILLE
library(data.table)
library(tidyverse)
dataCleaning <- function(data){
# changement du format des variables sensÃ©es Ãªtre numÃ©riques en numÃ©rique
data[, c("EFFET","COMPTE1","CT","MT","LT","IMPAYES","DOUTEUX","TRESORERIE",
"DOUTEUX_292","DOUTEUX_SIGNATURE", "PROVISION", "PROVISION_512",
"CREDOC","CONFIRME","CONFIRME_GROUPE", "CAUTION","SIGNATURE",
"TOTAL_ENG","GARANTIE","GAR_AUTRES","DEPOSIT_ENGAGEM","DEPOSIT_CREDOC" ,
"GAR_FINANCIERES","GAR_HYPOTHECAIR","GAR_ENTRE","GAR_ETAT_ORGAN",
"GAR_LETTRE","GAR_NANTISSEMENTS")] <- sapply(data[, c("EFFET","COMPTE1","CT","MT","LT","IMPAYES","DOUTEUX","TRESORERIE",
"DOUTEUX_292","DOUTEUX_SIGNATURE", "PROVISION", "PROVISION_512",
"CREDOC","CONFIRME","CONFIRME_GROUPE", "CAUTION","SIGNATURE",
"TOTAL_ENG","GARANTIE","GAR_AUTRES","DEPOSIT_ENGAGEM","DEPOSIT_CREDOC" ,
"GAR_FINANCIERES","GAR_HYPOTHECAIR","GAR_ENTRE","GAR_ETAT_ORGAN",
"GAR_LETTRE","GAR_NANTISSEMENTS")], as.numeric)
# structure de la table
glimpse(data)
# remplacer les valeurs manquantes par 0
data[, c("EFFET","COMPTE1","CT","MT","LT","IMPAYES","DOUTEUX","TRESORERIE",
"DOUTEUX_292","DOUTEUX_SIGNATURE", "PROVISION", "PROVISION_512",
"CREDOC","CONFIRME","CONFIRME_GROUPE", "CAUTION","SIGNATURE",
"TOTAL_ENG","GARANTIE","GAR_AUTRES","DEPOSIT_ENGAGEM","DEPOSIT_CREDOC" ,
"GAR_FINANCIERES","GAR_HYPOTHECAIR","GAR_ENTRE","GAR_ETAT_ORGAN",
"GAR_LETTRE","GAR_NANTISSEMENTS")] <- sapply(data[, c("EFFET","COMPTE1","CT","MT","LT","IMPAYES","DOUTEUX","TRESORERIE",
"DOUTEUX_292","DOUTEUX_SIGNATURE", "PROVISION", "PROVISION_512",
"CREDOC","CONFIRME","CONFIRME_GROUPE", "CAUTION","SIGNATURE",
"TOTAL_ENG","GARANTIE","GAR_AUTRES","DEPOSIT_ENGAGEM","DEPOSIT_CREDOC" ,
"GAR_FINANCIERES","GAR_HYPOTHECAIR","GAR_ENTRE","GAR_ETAT_ORGAN",
"GAR_LETTRE","GAR_NANTISSEMENTS")], function(x) {
x[is.na(x)] <- 0
x
})
# changer du format date des variables date
data$DATE_COMPTA <- as.Date(data$DATE_COMPTA, format = "%d/%m/%Y")
data$DATE_DECL <- as.Date(data$DATE_DECL, format = "%d/%m/%Y")
# Creation de la colonne des restructures
data <- data %>%
mutate(Restructures = TRESORERIE - DOUTEUX_292 - EFFET - COMPTE1 - CT - LT - MT - IMPAYES)
return(data)
}
# application de la fonction
final.df <- final.df %>%
dataCleaning
source("../CodesCredit/portef_bancaire.R")
source("CodesCredit/portef_bancaire.R")
source("CodesCredit/portef_bancaire.R")
source("CodesCredit/portef_bancaire.R")
runApp('~/R/Applications')
runApp('~/R/Applications')
runApp('~/R/Applications')
runApp('~/R/Applications')
runApp('~/R/Applications')
runApp('~/R/Applications')
runApp()
runApp('~/R/Applications')
runApp('~/R/Applications')
runApp('~/R/Applications')
runApp('~/R/Applications')
runApp('~/R/Applications')
pfEvol <- function(df, pays){
dates_compta <- unique(df$DATE_COMPTA)
dates_compta <- dates_compta[!is.na(dates_compta)]
dates_compta <- sort(dates_compta, decreasing = TRUE)
dates_compta_top3 <- dates_compta[1:3]
dates_compta_top3 <- dates_compta_top3[!is.na(dates_compta_top3)] # dans le cas où il y a moins de 3 arretés.
print(dates_compta_top3)
out <- data.frame(Intitule=c(
"Encours des effets",
"Credits Court terme",
"Credit Moyen et Long terme",
"Compte débiteurs",
"Impayes",
"Restructures",
"Credits Particuliers",
"Credits Entreprises"
))
for (date_compta in dates_compta_top3){
out <- df %>%
filter(Pays == pays, DATE_COMPTA==date_compta) %>%
SituationDuPortefeuille %>%
.$porte_f %>%
#rename(c("Montant"=as.character(format(date_compta)))) %>%
left_join(out)
}
names(out) <- NULL
names(out) <- c("Intitule", format(dates_compta_top3))
out$evol1 = (out[,4] - out[,3]) / out[,3]
out$evol2 = (out[,4] - out[,2]) / out[,2]
#out <- formatTable(out)
return(out)
}
final.df %>%
pfEvol("Benin") %>%
pfFormatTable(country = country, params = params)
final.df %>%
pfEvol("Benin")
pfEvol <- function(df, pays){
dates_compta <- unique(df$DATE_COMPTA)
dates_compta <- dates_compta[!is.na(dates_compta)]
dates_compta <- sort(dates_compta, decreasing = TRUE)
dates_compta_top3 <- dates_compta[1:3]
dates_compta_top3 <- dates_compta_top3[!is.na(dates_compta_top3)] # dans le cas où il y a moins de 3 arretés.
print(dates_compta_top3)
out <- data.frame(Intitule=c(
"Encours des effets",
"Credits Court terme",
"Credit Moyen et Long terme",
"Compte débiteurs",
"Impayes",
"Restructures",
"Credits Particuliers",
"Credits Entreprises"
))
for (date_compta in dates_compta_top3){
out <- df %>%
filter(Pays == pays, DATE_COMPTA==date_compta) %>%
SituationDuPortefeuille %>%
.$porte_f %>%
#rename(c("Montant"=as.character(format(date_compta)))) %>%
left_join(out)
}
print(names(out))
names(out) <- NULL
names(out) <- c("Intitule", format(dates_compta_top3))
out$evol1 = (out[,4] - out[,3]) / out[,3]
out$evol2 = (out[,4] - out[,2]) / out[,2]
#out <- formatTable(out)
return(out)
}
final.df %>%
pfEvol("Benin")
pfEvol <- function(df, pays){
dates_compta <- unique(df$DATE_COMPTA)
dates_compta <- dates_compta[!is.na(dates_compta)]
dates_compta <- sort(dates_compta, decreasing = TRUE)
dates_compta_top3 <- dates_compta[1:3]
dates_compta_top3 <- dates_compta_top3[!is.na(dates_compta_top3)] # dans le cas où il y a moins de 3 arretés.
print(dates_compta_top3)
out <- data.frame(Intitule=c(
"Encours des effets",
"Credits Court terme",
"Credit Moyen et Long terme",
"Compte débiteurs",
"Impayes",
"Restructures",
"Credits Particuliers",
"Credits Entreprises"
))
for (date_compta in dates_compta_top3){
out <- df %>%
filter(Pays == pays, DATE_COMPTA==date_compta) %>%
SituationDuPortefeuille %>%
.$porte_f %>%
rename(c("Montant"= paste(dates_compta, " "))) %>%
left_join(out)
}
print(names(out))
names(out) <- NULL
names(out) <- c("Intitule", format(dates_compta_top3))
out$evol1 = (out[,4] - out[,3]) / out[,3]
out$evol2 = (out[,4] - out[,2]) / out[,2]
#out <- formatTable(out)
return(out)
}
final.df %>%
pfEvol("Benin")
out <- df %>%
filter(Pays == pays, DATE_COMPTA==date_compta) %>%
SituationDuPortefeuille %>%
.$porte_f %>%
rename(c("Montant"= paste(dates_compta, "5"))) %>%
left_join(out)
pfEvol <- function(df, pays){
dates_compta <- unique(df$DATE_COMPTA)
dates_compta <- dates_compta[!is.na(dates_compta)]
dates_compta <- sort(dates_compta, decreasing = TRUE)
dates_compta_top3 <- dates_compta[1:3]
dates_compta_top3 <- dates_compta_top3[!is.na(dates_compta_top3)] # dans le cas où il y a moins de 3 arretés.
print(dates_compta_top3)
out <- data.frame(Intitule=c(
"Encours des effets",
"Credits Court terme",
"Credit Moyen et Long terme",
"Compte débiteurs",
"Impayes",
"Restructures",
"Credits Particuliers",
"Credits Entreprises"
))
for (date_compta in dates_compta_top3){
out <- df %>%
filter(Pays == pays, DATE_COMPTA==date_compta) %>%
SituationDuPortefeuille %>%
.$porte_f %>%
rename(c("Montant"= paste(dates_compta, "5"))) %>%
left_join(out)
}
print(names(out))
names(out) <- NULL
names(out) <- c("Intitule", format(dates_compta_top3))
out$evol1 = (out[,4] - out[,3]) / out[,3]
out$evol2 = (out[,4] - out[,2]) / out[,2]
#out <- formatTable(out)
return(out)
}
final.df %>%
pfEvol("Benin")
pfEvol <- function(df, pays){
dates_compta <- unique(df$DATE_COMPTA)
dates_compta <- dates_compta[!is.na(dates_compta)]
dates_compta <- sort(dates_compta, decreasing = TRUE)
dates_compta_top3 <- dates_compta[1:3]
dates_compta_top3 <- dates_compta_top3[!is.na(dates_compta_top3)] # dans le cas où il y a moins de 3 arretés.
print(dates_compta_top3)
out <- data.frame(Intitule=c(
"Encours des effets",
"Credits Court terme",
"Credit Moyen et Long terme",
"Compte débiteurs",
"Impayes",
"Restructures",
"Credits Particuliers",
"Credits Entreprises"
))
for (date_compta in dates_compta_top3){
out <- df %>%
filter(Pays == pays, DATE_COMPTA==date_compta) %>%
SituationDuPortefeuille %>%
.$porte_f %>%
rename(c(paste(dates_compta, " ") = "Montant")) %>%
left_join(out)
}
print(names(out))
names(out) <- NULL
names(out) <- c("Intitule", format(dates_compta_top3))
out$evol1 = (out[,4] - out[,3]) / out[,3]
out$evol2 = (out[,4] - out[,2]) / out[,2]
#out <- formatTable(out)
return(out)
}
pfEvol <- function(df, pays){
dates_compta <- unique(df$DATE_COMPTA)
dates_compta <- dates_compta[!is.na(dates_compta)]
dates_compta <- sort(dates_compta, decreasing = TRUE)
dates_compta_top3 <- dates_compta[1:3]
dates_compta_top3 <- dates_compta_top3[!is.na(dates_compta_top3)] # dans le cas où il y a moins de 3 arretés.
print(dates_compta_top3)
out <- data.frame(Intitule=c(
"Encours des effets",
"Credits Court terme",
"Credit Moyen et Long terme",
"Compte débiteurs",
"Impayes",
"Restructures",
"Credits Particuliers",
"Credits Entreprises"
))
for (date_compta in dates_compta_top3){
out <- df %>%
filter(Pays == pays, DATE_COMPTA==date_compta) %>%
SituationDuPortefeuille %>%
.$porte_f %>%
rename(c("Montant"= paste(dates_compta, " "))) %>%
left_join(out)
}
print(names(out))
names(out) <- NULL
names(out) <- c("Intitule", format(dates_compta_top3))
out$evol1 = (out[,4] - out[,3]) / out[,3]
out$evol2 = (out[,4] - out[,2]) / out[,2]
#out <- formatTable(out)
return(out)
}
final.df %>%
pfEvol("Benin")
pfEvol <- function(df, pays){
dates_compta <- unique(df$DATE_COMPTA)
dates_compta <- dates_compta[!is.na(dates_compta)]
dates_compta <- sort(dates_compta, decreasing = TRUE)
dates_compta_top3 <- dates_compta[1:3]
dates_compta_top3 <- dates_compta_top3[!is.na(dates_compta_top3)] # dans le cas où il y a moins de 3 arretés.
print(dates_compta_top3)
out <- data.frame(Intitule=c(
"Encours des effets",
"Credits Court terme",
"Credit Moyen et Long terme",
"Compte débiteurs",
"Impayes",
"Restructures",
"Credits Particuliers",
"Credits Entreprises"
))
for (date_compta in dates_compta_top3){
out <- df %>%
filter(Pays == pays, DATE_COMPTA==date_compta) %>%
SituationDuPortefeuille %>%
.$porte_f %>%
rename(c(paste(dates_compta, " ")="Montant")) %>%
left_join(out)
}
print(names(out))
names(out) <- NULL
names(out) <- c("Intitule", format(dates_compta_top3))
out$evol1 = (out[,4] - out[,3]) / out[,3]
out$evol2 = (out[,4] - out[,2]) / out[,2]
#out <- formatTable(out)
return(out)
}
final.df %>%
pfEvol("Benin")
pfEvol <- function(df, pays){
dates_compta <- unique(df$DATE_COMPTA)
dates_compta <- dates_compta[!is.na(dates_compta)]
dates_compta <- sort(dates_compta, decreasing = TRUE)
dates_compta_top3 <- dates_compta[1:3]
dates_compta_top3 <- dates_compta_top3[!is.na(dates_compta_top3)] # dans le cas où il y a moins de 3 arretés.
print(dates_compta_top3)
out <- data.frame(Intitule=c(
"Encours des effets",
"Credits Court terme",
"Credit Moyen et Long terme",
"Compte débiteurs",
"Impayes",
"Restructures",
"Credits Particuliers",
"Credits Entreprises"
))
for (date_compta in dates_compta_top3){
out <- df %>%
filter(Pays == pays, DATE_COMPTA==date_compta) %>%
SituationDuPortefeuille %>%
.$porte_f %>%
rename(c("Montant"= paste(date_compta, " "))) %>%
left_join(out)
}
print(names(out))
names(out) <- NULL
names(out) <- c("Intitule", format(dates_compta_top3))
out$evol1 = (out[,4] - out[,3]) / out[,3]
out$evol2 = (out[,4] - out[,2]) / out[,2]
#out <- formatTable(out)
return(out)
}
final.df %>%
pfEvol("Benin")
pfEvol <- function(df, pays){
dates_compta <- unique(df$DATE_COMPTA)
dates_compta <- dates_compta[!is.na(dates_compta)]
dates_compta <- sort(dates_compta, decreasing = TRUE)
dates_compta_top3 <- dates_compta[1:3]
dates_compta_top3 <- dates_compta_top3[!is.na(dates_compta_top3)] # dans le cas où il y a moins de 3 arretés.
print(dates_compta_top3)
out <- data.frame(Intitule=c(
"Encours des effets",
"Credits Court terme",
"Credit Moyen et Long terme",
"Compte débiteurs",
"Impayes",
"Restructures",
"Credits Particuliers",
"Credits Entreprises"
))
for (date_compta in dates_compta_top3){
out <- df %>%
filter(Pays == pays, DATE_COMPTA==date_compta) %>%
SituationDuPortefeuille %>%
.$porte_f %>%
rename(c("Montant"= paste(date_compta, ""))) %>%
left_join(out)
}
print(names(out))
names(out) <- NULL
names(out) <- c("Intitule", format(dates_compta_top3))
out$evol1 = (out[,4] - out[,3]) / out[,3]
out$evol2 = (out[,4] - out[,2]) / out[,2]
#out <- formatTable(out)
return(out)
}
final.df %>%
pfEvol("Benin")
library(plyr)
pfEvol <- function(df, pays){
dates_compta <- unique(df$DATE_COMPTA)
dates_compta <- dates_compta[!is.na(dates_compta)]
dates_compta <- sort(dates_compta, decreasing = TRUE)
dates_compta_top3 <- dates_compta[1:3]
dates_compta_top3 <- dates_compta_top3[!is.na(dates_compta_top3)] # dans le cas où il y a moins de 3 arretés.
print(dates_compta_top3)
out <- data.frame(Intitule=c(
"Encours des effets",
"Credits Court terme",
"Credit Moyen et Long terme",
"Compte débiteurs",
"Impayes",
"Restructures",
"Credits Particuliers",
"Credits Entreprises"
))
for (date_compta in dates_compta_top3){
out <- df %>%
filter(Pays == pays, DATE_COMPTA==date_compta) %>%
SituationDuPortefeuille %>%
.$porte_f %>%
rename(c("Montant"= paste(date_compta, ""))) %>%
left_join(out)
}
print(names(out))
names(out) <- NULL
names(out) <- c("Intitule", format(dates_compta_top3))
out$evol1 = (out[,4] - out[,3]) / out[,3]
out$evol2 = (out[,4] - out[,2]) / out[,2]
#out <- formatTable(out)
return(out)
}
final.df %>%
pfEvol("Benin")
runApp('~/R/Applications')
source("../../Coris/Reporting/Folder/CodesCredit/portef_bancaire.R")
source("/CodesCredit/portef_bancaire.R")
source("CodesCredit/portef_bancaire.R")
runApp('~/R/Applications')
runApp('~/R/Applications')
runApp('~/R/Applications')
runApp('~/R/Applications')
final.df %>%
pfEvol("Benin") %>%
pfFormatTable(country = country, params = params)
params = list(
arrete= as.Date("2020-12-31"),
prev1Arrete= as.Date("2020-11-30"),
prev2Arrete= as.Date("2020-10-31")
)
final.df %>%
pfEvol("Benin") %>%
pfFormatTable(country = country, params = params)
pfEvol <- function(df, pays){
dates_compta <- unique(df$DATE_COMPTA)
dates_compta <- dates_compta[!is.na(dates_compta)]
dates_compta <- sort(dates_compta, decreasing = TRUE)
dates_compta_top3 <- dates_compta[1:3]
dates_compta_top3 <- dates_compta_top3[!is.na(dates_compta_top3)] # dans le cas où il y a moins de 3 arretés.
print(dates_compta_top3)
out <- data.frame(Intitule=c(
"Encours des effets",
"Credits Court terme",
"Credit Moyen et Long terme",
"Compte débiteurs",
"Impayes",
"Restructures",
"Credits Particuliers",
"Credits Entreprises"
))
for (date_compta in dates_compta_top3){
out <- df %>%
filter(Pays == pays, DATE_COMPTA==date_compta) %>%
SituationDuPortefeuille %>%
.$porte_f %>%
rename(c("Montant"= paste(date_compta, ""))) %>%
left_join(out)
}
print(names(out))
names(out) <- NULL
names(out) <- c("Intitule", format(dates_compta_top3))
out$evol1 = (out[,4] - out[,3]) / out[,3]
out$evol2 = (out[,4] - out[,2]) / out[,2]
#out <- formatTable(out)
return(out)
}
final.df %>%
pfEvol("Benin") %>%
pfFormatTable(country = country, params = params)
###################### SITUATION DU PORTEFEUILLE ############################
params = list(
arrete= "2020-12-31",
prev1Arrete= "2020-11-30",
prev2Arrete= "2020-10-31"
)
final.df %>%
pfEvol("Benin") %>%
pfFormatTable(country = country, params = params)
runApp('~/R/Applications')
(1914.88 - 1965.24) / 1965.24
runApp('~/Coris/Notation/notation')
runApp('~/Coris/Notation/notation')
runApp('~/Coris/Notation/notation')
runApp('~/Coris/Notation/notation')
runApp('~/Coris/Notation/notation')
runApp('~/Coris/Notation/notation')
runApp('~/Coris/Notation/notation')
runApp()
runApp('~/Coris/Notation/notation')
